(this["webpackJsonpportfolio-viewer"]=this["webpackJsonpportfolio-viewer"]||[]).push([[0],{84:function(e,t,r){e.exports=r(98)},89:function(e,t,r){},95:function(e,t,r){},98:function(e,t,r){"use strict";r.r(t);var n,a,o=r(0),i=r.n(o),c=r(8),l=r.n(c),u=(r(89),r(154)),s=r(128),p=r(131),f=r(39),m=function(){return i.a.createElement(s.a,{position:"absolute"},i.a.createElement(p.a,null,i.a.createElement(f.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0},"IBKR portfolio viewer")))},d=r(132),O=r(75),y=Object(O.a)(),E=function(e){var t=e.children;return i.a.createElement(d.a,{theme:y},t)},b=r(102),g=r(100),v=r(150),h=r(137),j=r(99),P=r(14),w=r(1),T=r(2),D=r(133),S=r(134),I=function(e){var t=e.label,r=e.children;return i.a.createElement(D.a,{component:"fieldset"},i.a.createElement(S.a,{component:"legend"},t),r)},x=r(153),R=r(135),F=r(152),k=function(e){e.prefix;var t=e.options,r=e.selectedValue,n=e.onSelected,a=Object(T.a)(e,["prefix","options","selectedValue","onSelected"]);return i.a.createElement(I,a,i.a.createElement(x.a,{"aria-label":"gender",name:"gender1",value:r,onChange:function(e){return n(+e.target.value)}},Object.keys(t).map((function(e){return i.a.createElement(R.a,{key:e,value:t[e],control:i.a.createElement(F.a,null),label:e})}))))};!function(e){e[e.All=1]="All",e[e.Expired=2]="Expired",e[e.Open=3]="Open"}(n||(n={})),function(e){e[e.All=1]="All",e[e.Closed=2]="Closed",e[e.Open=3]="Open"}(a||(a={}));var L,_=function(e){return e.filters.dateFilter},A=function(e){return e.filters.positionFilter};!function(e){e.DATE_FILTER_SELECTED="FILTERS/DATE_FILTER_SELECTED",e.POSITION_FILTER_SELECTED="FILTERS/POSITION_FILTER_SELECTED"}(L||(L={}));var C,H=function(e){return e.portfolio.filteredPortfolio},N=function(e){if(e.portfolio.filteredPortfolio)return{TotalPL:-e.portfolio.filteredPortfolio.tradeGroups.reduce((function(e,t){return e+t.trades.reduce((function(e,t){return e+t.tradePrice}),0)}),0)}},B=r(34),G=r(7);!function(e){e.HISTORY_LOADED="IMPORT/HISTORY_LOADED",e.REPORT_LOADED_FROM_HISTORY="IMPORT/REPORT_LOADED_FROM_HISTORY"}(C||(C={}));var M;!function(e){e[e.PORTFOLIO_FILTERED=0]="PORTFOLIO_FILTERED"}(M||(M={}));function Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Y(r,!0).forEach((function(t){Object(G.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var q={portfolio:void 0,filteredPortfolio:void 0};function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(r,!0).forEach((function(t){Object(G.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var V={dateFilter:n.All,positionFilter:a.All};function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(r,!0).forEach((function(t){Object(G.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var $={history:[]},z=r(65),Q=Object(B.combineReducers)({portfolio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C.REPORT_LOADED_FROM_HISTORY:return{portfolio:t.payload,filteredPortfolio:t.payload};case M.PORTFOLIO_FILTERED:return W({},e,{filteredPortfolio:t.payload});default:return e}},importHistory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C.HISTORY_LOADED:return X({},e,{history:t.payload});default:return e}},filters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L.DATE_FILTER_SELECTED:return K({},e,{dateFilter:t.payload});case L.POSITION_FILTER_SELECTED:return K({},e,{positionFilter:t.payload});case C.REPORT_LOADED_FROM_HISTORY:return V;default:return e}}}),Z=Object(B.createStore)(Q,Object(z.composeWithDevTools)()),ee=r(18),te=r(15);function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(r,!0).forEach((function(t){Object(G.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ae,oe=function(e){return function(t){var r;t((r=e,{type:L.DATE_FILTER_SELECTED,payload:r})),le(t)}},ie=function(e){return function(t){var r;t((r=e,{type:L.POSITION_FILTER_SELECTED,payload:r})),le(t)}},ce=new(function(){function e(){Object(ee.a)(this,e),this.filterByDate=function(e){return function(t){var r,a=(r={},Object(G.a)(r,n.All,(function(){return!0})),Object(G.a)(r,n.Expired,(function(e){return e.expiration<new Date})),Object(G.a)(r,n.Open,(function(e){return e.expiration>new Date})),r);return ne({},t,{tradeGroups:t.tradeGroups.filter(a[e])})}},this.filterByPosition=function(e){return function(t){var r,n=function(e){return function(t){return e.optionType===t.optionType&&e.strikePrice===t.strikePrice&&e.position===-1*t.position}},o=(r={},Object(G.a)(r,a.All,(function(e){return e})),Object(G.a)(r,a.Closed,(function(e){var t=e.trades.filter((function(t){return e.trades.find(n(t))}));return ne({},e,{trades:t})})),Object(G.a)(r,a.Open,(function(e){var t=e.trades.filter((function(t){return!e.trades.find(n(t))}));return ne({},e,{trades:t})})),r);return ne({},t,{tradeGroups:t.tradeGroups.map(o[e]).filter((function(e){return e.trades.length>0}))})}}}return Object(te.a)(e,[{key:"applyFilters",value:function(e,t){return[this.filterByDate(t.dateFilter),this.filterByPosition(t.positionFilter)].reduce((function(e,t){return t(e)}),e)}}]),e}()),le=function(e){var t=Z.getState().portfolio.portfolio;if(t){var r,n=Z.getState().filters,a=ce.applyFilters(t,n);e((r=a,{type:M.PORTFOLIO_FILTERED,payload:r}))}},ue={All:n.All,Expired:n.Expired,Open:n.Open},se=Object(P.b)((function(e){return{selectedValue:_(e)}}),(function(e){return{onSelected:function(t){oe(t)(e)}}}))((function(e){var t=Object(w.a)({},e);return i.a.createElement(k,Object.assign({prefix:"date",label:"By Date",options:ue},t))})),pe={All:a.All,Closed:a.Closed,Open:a.Open},fe=Object(P.b)((function(e){return{selectedValue:A(e)}}),(function(e){return{onSelected:function(t){ie(t)(e)}}}))((function(e){var t=Object(w.a)({},e);return i.a.createElement(k,Object.assign({prefix:"position",label:"By Position",options:pe},t))})),me=(r(95),function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"Filters"),i.a.createElement(h.a,{container:!0,spacing:2},i.a.createElement(h.a,{item:!0,xs:4},i.a.createElement(se,null)),i.a.createElement(h.a,{item:!0,xs:4},i.a.createElement(fe,null))))}),de=r(66),Oe=r.n(de),ye=r(46),Ee=r.n(ye),be=function(e){var t=e.summary;return void 0===t?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"Summary"),"Total P/L:",i.a.createElement(f.a,{component:"span",style:{color:t.TotalPL<0?Ee.a[500]:Oe.a[500]}},"$",(100*t.TotalPL).toFixed(2)))},ge=Object(P.b)((function(e){return{summary:N(e)}}))(be),ve=["action","underlying","optionType","optionTarget","position","price","expiration","remainingDays"],he=r(138),je=r(139),Pe=r(140),we={action:"",underlying:"Underlying",optionTarget:"Option Target",optionType:"Option Type",position:"Position",expiration:"Expiration",price:"Price",remainingDays:"Remaining days"},Te=function(){return i.a.createElement(he.a,null,i.a.createElement(je.a,null,ve.map((function(e){return i.a.createElement(Pe.a,{key:e},we[e])}))))},De=r(48);!function(e){e[e.Call=1]="Call",e[e.Put=2]="Put"}(ae||(ae={}));var Se=r(141),Ie=r(4),xe=r(142),Re=r(50),Fe=Object(Se.a)({win:{background:xe.a[700],color:"white"},loss:{background:Re.a[700],color:"white"}}),ke=Object(Ie.a)(Fe)((function(e){var t=e.price,r=e.classes;return i.a.createElement(Pe.a,{className:t>0?r.loss:r.win},function(e){return e<0?(-1*e).toFixed(2):e.toFixed(2)}(t))})),Le=function(e,t){return i.a.createElement(Pe.a,{className:e,key:e},t)},_e={action:function(){return Le("action","")},underlying:function(e){return Le("underlying",e.underlying)},optionType:function(e){return Le("optionType",e.optionType===ae.Call?"CALL":"PUT")},optionTarget:function(e){return Le("optionTarget",e.strikePrice.toString())},position:function(e){return Le("position",e.position.toString())},expiration:function(e){return Le("expiration",e.expiration.toLocaleDateString())},price:function(e){return i.a.createElement(ke,{key:"price",price:e.tradePrice})},remainingDays:function(){return Le("remainingDays","")}},Ae=function(e){var t=e.trade;return i.a.createElement(je.a,null,ve.map((function(e){return _e[e](t)})))},Ce=r(136),He=r(69),Ne=r.n(He),Be=r(3),Ge=r(49);function Me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Ye=function(e,t){return i.a.createElement(Pe.a,{key:e,className:e},t)},We=function(e){return function(t){return Ye(e,"")}},qe=Object(g.a)((function(e){return Object(b.a)({expand:{padding:0,transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},groupRow:{background:Ge.a[300]}})}))((function(e){var t=e.tradeGroup,r=e.classes,n=Object(o.useState)(!1),a=Object(De.a)(n,2),c=a[0],l=a[1],u={action:function(e){return Ye("action",i.a.createElement(Ce.a,{"aria-label":"share",onClick:function(){l(!c)},className:Object(Be.a)(r.expand,Object(G.a)({},r.expandOpen,e.isOpen))},i.a.createElement(Ne.a,null)))},underlying:function(e){return Ye("underlying",e.underlying)},optionType:We("optionType"),optionTarget:We("optionTarget"),position:We("position"),price:function(e){return i.a.createElement(ke,{key:"price",price:e.trades.reduce((function(e,t){return e+t.tradePrice}),0)})},expiration:function(e){return Ye("expiration",e.expiration.toLocaleDateString())},remainingDays:function(e){return Ye("remainingDays",function(e){var t=new Date,r=Math.floor((Number(e)-Number(t))/1e3/60/60/24);return r<0?"EXPIRED":r.toString()}(e.expiration))}},s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Me(r,!0).forEach((function(t){Object(G.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Me(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{isOpen:c});return i.a.createElement(i.a.Fragment,null,i.a.createElement(je.a,{className:r.groupRow},ve.map((function(e){return u[e](s)}))),c?t.trades.map((function(e,t){return i.a.createElement(Ae,{trade:e,key:t})})):null)})),Je=r(143),Ke=r(144),Ve=function(e){var t=e.report;return i.a.createElement(Je.a,null,i.a.createElement(Te,null),i.a.createElement(Ke.a,null,t.tradeGroups.map((function(e,t){return i.a.createElement(qe,{tradeGroup:e,key:t})}))))},Ue=function(e){var t=e.report;return t?i.a.createElement(h.a,{container:!0,spacing:2},i.a.createElement(h.a,{item:!0,xs:12,md:6},i.a.createElement(ge,null)),i.a.createElement(h.a,{item:!0,xs:12,md:6},i.a.createElement(me,null)),i.a.createElement(h.a,{item:!0,xs:12},i.a.createElement(Ve,{report:t}))):null},Xe=Object(P.b)((function(e){return{report:H(e)}}))(Ue),$e=r(145),ze=r(146),Qe=r(147),Ze=r(148),et=r(70),tt=r.n(et),rt=r(71),nt=r.n(rt),at=Object(b.a)({delete:{"&:hover":{color:Ee.a[700]}}}),ot=Object(g.a)(at)((function(e){var t=e.history,r=e.importFromHistory,n=e.loadHistory,a=e.deleteFromHistory,c=e.classes;return Object(o.useEffect)((function(){n()}),[n]),i.a.createElement(h.a,null,i.a.createElement(f.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"Imported reports"),i.a.createElement($e.a,{component:"nav","aria-label":"Main mailbox folders"},t.map((function(e){return i.a.createElement(ze.a,{button:!0,onClick:function(){return r(e)},key:e},i.a.createElement(Qe.a,null,i.a.createElement(tt.a,null)),i.a.createElement(Ze.a,{primary:e}),i.a.createElement(Ce.a,{className:c.delete,onClick:function(t){a(e),t.stopPropagation()}},i.a.createElement(nt.a,null)))}))))})),it=r(54),ct=r.n(it),lt=r(72),ut=function(){function e(){Object(ee.a)(this,e)}return Object(te.a)(e,[{key:"getSavedHistory",value:function(){var e=localStorage.getItem("savedImports");return e?JSON.parse(e):{rawImports:{}}}},{key:"saveHistory",value:function(e){var t=JSON.stringify(e);localStorage.setItem("savedImports",t)}},{key:"GetRawImportKeys",value:function(){var e=this.getSavedHistory();return Object.keys(e.rawImports)}},{key:"GetRawImport",value:function(e){return this.getSavedHistory().rawImports[e]}},{key:"SaveRawImport",value:function(e){var t=this.getSavedHistory(),r=(new Date).getUTCMilliseconds().toString();t.rawImports[r]=e,this.saveHistory(t)}},{key:"DeleteReport",value:function(e){var t=this.getSavedHistory();if(!t.rawImports[e])throw Error("Key not found in saved history: ".concat(e));delete t.rawImports[e],this.saveHistory(t)}}]),e}(),st=r(73),pt=r(74),ft=r(76),mt=function(e){function t(){return Object(ee.a)(this,t),Object(st.a)(this,Object(pt.a)(t).apply(this,arguments))}return Object(ft.a)(t,e),Object(te.a)(t,[{key:"ParseMyTrades",value:function(e){var t=(new DOMParser).parseFromString(e,"text/xml");return Array.from(t.getElementsByTagName("Trade")).map((function(e){var t=e.getAttribute("expiry"),r=parseInt(e.getAttribute("quantity"));return{underlying:e.getAttribute("underlyingSymbol"),position:r,expiration:new Date(+t.substr(0,4),+t.substr(4,2)-1,+t.substr(6,2)),optionType:"P"===e.getAttribute("putCall")?ae.Put:ae.Call,strikePrice:+e.getAttribute("strike"),tradePrice:(r<0?-1:1)*+e.getAttribute("tradePrice")}}))}}]),t}(function(){function e(){Object(ee.a)(this,e),this.rawImport=""}return Object(te.a)(e,[{key:"Parse",value:function(e){var t,r,n=this;this.rawImport="";var a=new Promise((function(e,n){t=e,r=n}));console.debug("Parsing ".concat(e.name,"..."));var o=new FileReader;return o.onload=function(){console.debug("File loaded.");var e=o.result;n.rawImport=e;try{t(n.rawImport)}catch(a){n.rawImport="",r("Error while parsing...")}},o.readAsBinaryString(e),a}},{key:"getGroupsFromTrades",value:function(e){var t=e.reduce((function(e,t){var r=t.expiration,n=t.underlying,a="".concat(n," - ").concat(r.toLocaleDateString());return e[a]||(e[a]={underlying:n,expiration:r,trades:[]}),e[a].trades.push(t),e}),{});return Object.values(t).sort((function(e,t){return+e.expiration-+t.expiration}))}},{key:"ParseRawData",value:function(e){var t=this.ParseMyTrades(e);return{name:"ok",tradeGroups:this.getGroupsFromTrades(t)}}}]),e}()),dt=new ut,Ot=new mt,yt=function(e){return function(t){var r=dt.GetRawImport(e);return t(function(e){return{type:C.REPORT_LOADED_FROM_HISTORY,payload:e}}(Ot.ParseRawData(r)))}},Et=function(){return function(e){return e(function(e){return{type:C.HISTORY_LOADED,payload:e}}(dt.GetRawImportKeys()))}},bt=function(e){return e.importHistory.history},gt=Object(P.b)((function(e){return{history:bt(e)}}),(function(e){return{importFromHistory:function(t){yt(t)(e)},deleteFromHistory:function(t){var r;(r=t,function(e){return dt.DeleteReport(r),Et()(e)})(e)},loadHistory:function(){return Et()(e)}}}))(ot),vt=r(149),ht=r(151),jt=Object(Ie.a)((function(){return Object(Se.a)({input:{display:"none"}})}))((function(e){var t=e.upload,r=e.classes,n=Object(o.useState)(),a=Object(De.a)(n,2),c=a[0],l=a[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement("input",{className:r.input,id:"raised-button-file",type:"file",onChange:function(e){return l(e.target.files)}}),i.a.createElement(ht.a,{value:c&&c.length?c[0].name:void 0,placeholder:"No file chosen"}),i.a.createElement("label",{htmlFor:"raised-button-file"},i.a.createElement(vt.a,{component:"span"},"Select file")),c&&c.length?i.a.createElement(vt.a,{onClick:function(){c&&1===c.length?t(c[0]):alert("please provide a single file!")},color:"primary",variant:"contained"},"Import"):null)})),Pt=function(e){var t=e.importFile;return i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"Import flex query"),i.a.createElement(h.a,{container:!0,spacing:1},i.a.createElement(h.a,{item:!0,xs:12},i.a.createElement(jt,{upload:t})),i.a.createElement(h.a,{item:!0,xs:12},"If you have no flex queries exported yet:\xa0",i.a.createElement(vt.a,{onClick:function(){return function(){var e=new XMLHttpRequest;e.open("GET","example.xml"),e.responseType="blob",e.onload=function(){t(e.response)},e.send()}()},color:"primary",variant:"contained"},"Load example"))))},wt=Object(P.b)(null,(function(e){return{importFile:function(t){return function(e){return function(){var t=Object(lt.a)(ct.a.mark((function t(r){var n;return ct.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ot.Parse(e);case 2:n=t.sent,dt.SaveRawImport(n),Et()(r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t)(e)}}}))(Pt),Tt=Object(g.a)((function(e){return Object(b.a)({root:{display:"flex"},appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"}})}))((function(e){var t=e.classes;return i.a.createElement("main",{className:t.content},i.a.createElement("div",{className:t.appBarSpacer}),i.a.createElement(v.a,{maxWidth:"lg",className:t.container},i.a.createElement(h.a,{container:!0,spacing:3},i.a.createElement(h.a,{item:!0,xs:12,md:6},i.a.createElement(j.a,{className:t.paper},i.a.createElement(gt,null))),i.a.createElement(h.a,{item:!0,xs:12,md:6},i.a.createElement(j.a,{className:t.paper},i.a.createElement(wt,null))),i.a.createElement(h.a,{item:!0,xs:12},i.a.createElement(j.a,{className:t.paper},i.a.createElement(Xe,null))))))})),Dt=function(){return i.a.createElement(E,null,i.a.createElement(P.a,{store:Z},i.a.createElement("div",{className:"app"},i.a.createElement(u.a,null),i.a.createElement(m,null),i.a.createElement(Tt,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(Dt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[84,1,2]]]);
//# sourceMappingURL=main.c3493595.chunk.js.map